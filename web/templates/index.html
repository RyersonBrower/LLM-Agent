<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LLM Agent</title>
    <style>
        body { font-family: Arial; margin: 2rem; }
        input, button, textarea { padding: 0.5rem; margin: 0.5rem 0; width: 100%; }
        #history { margin-top: 2rem; }
        .entry { background: #f0f0f0; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; }
        .you { font-weight: bold; }
        .agent { margin-top: 0.5rem; }
    </style>
</head>
<body>
<h1>LLM Agent</h1>

<form id="askForm" enctype="multipart/form-data">
    <input type="text" id="question" name="question" placeholder="Ask a question..." required />

    <label>Upload files (PDF, TXT, DOCX):</label>
    <input type="file" id="files" name="files" multiple />

    <label>Website URLs (comma-separated):</label>
    <input type="text" id="urls" name="urls" placeholder="https://example.com, ...">

    <button type="submit">Ask</button>
</form>

<div id="history"></div>

<script>
const form = document.getElementById("askForm");
const historyDiv = document.getElementById("history");

form.onsubmit = async (e) => {
    e.preventDefault();

    const formData = new FormData();
    formData.append("question", document.getElementById("question").value);
    formData.append("urls", document.getElementById("urls").value);

    for (let file of document.getElementById("files").files) {
        formData.append("files", file);
    }

    const res = await fetch("/ask", {
        method: "POST",
        body: formData
    });

    const data = await res.json();

    historyDiv.innerHTML = "";
    data.history.forEach(entry => {
        historyDiv.innerHTML += `
        <div class="entry">
            <div class="you">You: ${entry.question}</div>
            <div class="agent">Agent: ${entry.answer}</div>
            ${entry.sources && entry.sources.length ? `
                <div class="sources">
                    <strong>Sources:</strong> 
                    ${entry.sources.map(s => s.name).join(", ")}
                </div>
` : ""}
        </div>
        `;
    });
};
</script>

</body>
</html>

